{"question": "What is the return window for Beverages?", "schema": "", "constraints_json": "{\"kpi\":\"return_window\", \"category\":\"Beverages\"}", "sql": "SELECT ReturnWindow FROM ProductPolicy WHERE CategoryName='Beverages' LIMIT 1;"}
{"question": "List top 3 products by total revenue all time.", "schema": "", "constraints_json": "{\"kpi\":\"revenue\", \"top_n\":3}", "sql": "SELECT p.ProductName AS product, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue FROM `Order Details` od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY revenue DESC LIMIT 3;"}
{"question": "What is the total revenue for Beverages in Summer 1997?", "schema": "", "constraints_json": "{\"kpi\":\"revenue\", \"category\":\"Beverages\", \"start_date\":\"1997-06-01\", \"end_date\":\"1997-09-01\"}", "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS total_revenue FROM `Order Details` od JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID JOIN Orders o ON o.OrderID = od.OrderID WHERE c.CategoryName='Beverages' AND o.OrderDate >= '1997-06-01' AND o.OrderDate < '1997-09-01';"}
{"question": "Which category sold the highest quantity in June 1997?", "schema": "", "constraints_json": "{\"kpi\":\"quantity\", \"start_date\":\"1997-06-01\", \"end_date\":\"1997-07-01\"}", "sql": "SELECT c.CategoryName, SUM(od.Quantity) AS qty FROM `Order Details` od JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate >= '1997-06-01' AND o.OrderDate < '1997-07-01' GROUP BY c.CategoryName ORDER BY qty DESC LIMIT 1;"}
{"question": "Find the average order value in 1997.", "schema": "", "constraints_json": "{\"kpi\":\"aov\", \"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS aov FROM `Order Details` od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01';"}
{"question": "Which customer had the highest revenue in 1997?", "schema": "", "constraints_json": "{\"kpi\":\"revenue\", \"start_date\":\"1997-01-01\", \"end_date\":\"1998-01-01\"}", "sql": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue FROM Customers c JOIN Orders o ON c.CustomerID=o.CustomerID JOIN `Order Details` od ON o.OrderID=od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01' GROUP BY c.CustomerID ORDER BY revenue DESC LIMIT 1;"}
{"question": "What is the total quantity sold for Condiments in 1997?", "schema": "", "constraints_json": "{\"kpi\":\"quantity\", \"category\":\"Condiments\", \"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT SUM(od.Quantity) FROM `Order Details` od JOIN Products p ON p.ProductID=od.ProductID JOIN Categories c ON c.CategoryID=p.CategoryID JOIN Orders o ON o.OrderID=od.OrderID WHERE c.CategoryName='Condiments' AND o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01';"}
{"question": "List revenue per category for 1997.", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"group_by\":\"category\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT c.CategoryName, SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) AS revenue FROM `Order Details` od JOIN Products p ON p.ProductID=od.ProductID JOIN Categories c ON c.CategoryID=p.CategoryID JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01' GROUP BY c.CategoryName;"}
{"question": "Top customer by margin in 1997.", "schema": "", "constraints_json": "{\"kpi\":\"margin\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT c.CustomerID, (SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) - SUM(od.UnitPrice*od.Quantity*0.7)) AS margin FROM Customers c JOIN Orders o ON c.CustomerID=o.CustomerID JOIN `Order Details` od ON o.OrderID=od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01' GROUP BY c.CustomerID ORDER BY margin DESC LIMIT 1;"}
{"question": "Total revenue for all categories in Summer 1997.", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"start_date\":\"1997-06-01\",\"end_date\":\"1997-09-01\"}", "sql": "SELECT SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) AS revenue FROM `Order Details` od JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate >= '1997-06-01' AND o.OrderDate < '1997-09-01';"}
{"question": "Top 5 customers by quantity purchased in 1997.", "schema": "", "constraints_json": "{\"kpi\":\"quantity\",\"top_n\":5, \"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT c.CustomerID, SUM(od.Quantity) AS qty FROM Customers c JOIN Orders o ON c.CustomerID=o.CustomerID JOIN `Order Details` od ON o.OrderID=od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate<'1998-01-01' GROUP BY c.CustomerID ORDER BY qty DESC LIMIT 5;"}
{"question": "Revenue for Chai in 1997.", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"product\":\"Chai\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) FROM `Order Details` od JOIN Products p ON p.ProductID=od.ProductID JOIN Orders o ON o.OrderID=od.OrderID WHERE p.ProductName='Chai' AND o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01';"}
{"question": "Which product had the highest discount impact in 1997?", "schema": "", "constraints_json": "{\"kpi\":\"discount_impact\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT p.ProductName, SUM(od.UnitPrice * od.Quantity * od.Discount) AS discount_value FROM `Order Details` od JOIN Products p ON p.ProductID=od.ProductID JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01' GROUP BY p.ProductName ORDER BY discount_value DESC LIMIT 1;"}
{"question": "Which month in 1997 had the highest revenue?", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"group_by\":\"month\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT strftime('%Y-%m',o.OrderDate) AS month, SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) AS revenue FROM `Order Details` od JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate < '1998-01-01' GROUP BY month ORDER BY revenue DESC LIMIT 1;"}
{"question": "Average quantity per order in 1997.", "schema": "", "constraints_json": "{\"kpi\":\"avg_quantity\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT AVG(od.Quantity) FROM `Order Details` od JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate>='1997-01-01' AND o.OrderDate<'1998-01-01';"}
{"question": "Revenue of each category in Summer 1997.", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"group_by\":\"category\",\"start_date\":\"1997-06-01\",\"end_date\":\"1997-09-01\"}", "sql": "SELECT c.CategoryName, SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) AS revenue FROM `Order Details` od JOIN Products p ON p.ProductID=od.ProductID JOIN Categories c ON c.CategoryID=p.CategoryID JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate>='1997-06-01' AND o.OrderDate<'1997-09-01' GROUP BY c.CategoryName;"}
{"question": "Top employee by sales in 1997.", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"group_by\":\"employee\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT e.EmployeeID, SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) AS sales FROM Employees e JOIN Orders o ON e.EmployeeID=o.EmployeeID JOIN `Order Details` od ON od.OrderID=o.OrderID WHERE o.OrderDate>='1997-01-01' AND o.OrderDate<'1998-01-01' GROUP BY e.EmployeeID ORDER BY sales DESC LIMIT 1;"}
{"question": "Which category had the lowest revenue in 1997?", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"group_by\":\"category\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT c.CategoryName, SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) AS revenue FROM `Order Details` od JOIN Products p ON p.ProductID=od.ProductID JOIN Categories c ON c.CategoryID=p.CategoryID JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate>='1997-01-01' AND o.OrderDate<'1998-01-01' GROUP BY c.CategoryName ORDER BY revenue ASC LIMIT 1;"}
{"question": "Which product had the highest quantity sold in 1997?", "schema": "", "constraints_json": "{\"kpi\":\"quantity\",\"group_by\":\"product\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT p.ProductName, SUM(od.Quantity) AS qty FROM `Order Details` od JOIN Products p ON p.ProductID=od.ProductID JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate>='1997-01-01' AND o.OrderDate<'1998-01-01' GROUP BY p.ProductName ORDER BY qty DESC LIMIT 1;"}
{"question": "Total number of orders in 1997.", "schema": "", "constraints_json": "{\"kpi\":\"count_orders\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT COUNT(*) FROM Orders WHERE OrderDate>='1997-01-01' AND OrderDate<'1998-01-01';"}
{"question": "Which customer had the fewest orders in 1997?", "schema": "", "constraints_json": "{\"kpi\":\"count_orders\",\"group_by\":\"customer\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT c.CustomerID, COUNT(o.OrderID) AS count_orders FROM Customers c JOIN Orders o ON c.CustomerID=o.CustomerID WHERE o.OrderDate>='1997-01-01' AND o.OrderDate<'1998-01-01' GROUP BY c.CustomerID ORDER BY count_orders ASC LIMIT 1;"}
{"question": "What is the total discount given in 1997?", "schema": "", "constraints_json": "{\"kpi\":\"discount\",\"start_date\":\"1997-01-01\",\"end_date\":\"1998-01-01\"}", "sql": "SELECT SUM(od.UnitPrice*od.Quantity*od.Discount) AS total_discount FROM `Order Details` od JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate>='1997-01-01' AND o.OrderDate<'1998-01-01';"}
{"question": "Average revenue per order in Summer 1997.", "schema": "", "constraints_json": "{\"kpi\":\"aov\",\"start_date\":\"1997-06-01\",\"end_date\":\"1997-09-01\"}", "sql": "SELECT SUM(od.UnitPrice*od.Quantity*(1-od.Discount))/COUNT(DISTINCT o.OrderID) AS aov FROM `Order Details` od JOIN Orders o ON o.OrderID=od.OrderID WHERE o.OrderDate>='1997-06-01' AND o.OrderDate<'1997-09-01';"}
{"question": "Which customer spent the most in Summer 1997?", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"start_date\":\"1997-06-01\",\"end_date\":\"1997-09-01\"}", "sql": "SELECT c.CustomerID, SUM(od.UnitPrice*od.Quantity*(1-od.Discount)) AS revenue FROM Customers c JOIN Orders o ON c.CustomerID=o.CustomerID JOIN `Order Details` od ON o.OrderID=od.OrderID WHERE o.OrderDate>='1997-06-01' AND o.OrderDate<'1997-09-01' GROUP BY c.CustomerID ORDER BY revenue DESC LIMIT 1;"}
{"question": "Which category had the highest quantity sold in Summer 1997?", "schema": "", "constraints_json": "{\"kpi\":\"quantity\",\"group_by\":\"category\",\"start_date\":\"1997-06-01\",\"end_date\":\"1997-09-01\"}", "sql": "SELECT c.CategoryName, SUM(od.Quantity) AS qty FROM `Order Details` od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE o.OrderDate >= '1997-06-01' AND o.OrderDate < '1997-09-01' GROUP BY c.CategoryName ORDER BY qty DESC LIMIT 1;"}
{"question": "What is the average order value (AOV) during Winter 1997?", "schema": "", "constraints_json": "{\"kpi\":\"aov\",\"start_date\":\"1997-01-01\",\"end_date\":\"1997-03-31\"}", "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS aov FROM `Order Details` od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate >= '1997-01-01' AND o.OrderDate < '1997-03-31';"}
{"question": "What is the total revenue for Beverages in Summer 1997?", "schema": "", "constraints_json": "{\"kpi\":\"revenue\",\"category\":\"Beverages\",\"start_date\":\"1997-06-01\",\"end_date\":\"1997-09-01\"}", "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS total_revenue FROM `Order Details` od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' AND o.OrderDate >= '1997-06-01' AND o.OrderDate < '1997-09-01';"}
